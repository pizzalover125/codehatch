---
const { width = 200, height = 200, label = 'Image', class: className = '' } = Astro.props;
const isTall = (className || '').split(' ').includes('tall');
const styleAttr = isTall ? `width:${width}px;` : `width:${width}px; height:${height}px;`;
---

<div class={`image-placeholder ${className}`} role="img" aria-label={label} style={styleAttr}>
  <div class="placeholder-inner">
    <svg width="36" height="36" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
      <rect x="3" y="3" width="18" height="18" rx="2" stroke="currentColor" stroke-opacity="0.32" stroke-width="1.5" />
      <path d="M7 14l3-3 5 5" stroke="currentColor" stroke-opacity="0.32" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
      <circle cx="15" cy="8" r="1" fill="currentColor" fill-opacity="0.32" />
    </svg>
    <span class="placeholder-label">{label}</span>
  </div>
</div>

<style>
  .image-placeholder{
    display: inline-flex;
    align-items: center;
    justify-content: center;
    background: linear-gradient(180deg, rgba(0,0,0,0.02), rgba(0,0,0,0.01));
    border: 3px solid var(--accent-orange);
    color: var(--text-muted, #7a7a7a);
    border-radius: 12px;
    box-shadow: 0 8px 28px rgba(10,10,10,0.06);
    padding: 0.75rem;
    box-sizing: border-box;
    position: relative;
    transform-origin: center;
  }

  .image-placeholder{ --placeholder-accent: var(--accent-orange); }

  /* Restore decorative flair: subtle rotations and accents */
  .image-placeholder.flair-twist{ transform: rotate(-3deg) translateY(-6px); overflow: visible; }
  .image-placeholder.flair-twist::before{ content: ''; position: absolute; left: -18px; top: 12px; width: 40px; height: 40px; border-radius: 10px; background: var(--placeholder-accent); transform: rotate(-12deg); filter: blur(6px); opacity: 0.12; z-index: 0; }
  .image-placeholder.flair-twist::after{ content: ''; position: absolute; right: -12px; bottom: -12px; width: 60px; height: 60px; border-radius: 50%; border: 4px solid var(--placeholder-accent); z-index: 0; transform: translateZ(0); }

  .image-placeholder.flair-spark{ transform: rotate(2deg) translateY(-4px); }
  .image-placeholder.flair-spark::before{ content: ''; position: absolute; right: 6px; top: -8px; width: 22px; height: 22px; border-radius: 6px; background: radial-gradient(circle at 30% 30%, var(--placeholder-accent), transparent 60%); filter: blur(4px); opacity: 0.18; z-index: 0; }
  /* removed small circular "ball" */

  .image-placeholder.flair-spot{ transform: rotate(-2.5deg) translateY(-6px); }
  .image-placeholder.flair-spot::before{ content: ''; position: absolute; left: -28px; top: 20%; width: 80px; height: 80px; border-radius: 14px; background: radial-gradient(circle at 10% 30%, var(--placeholder-accent), transparent 45%); filter: blur(14px); opacity: 0.14; z-index: 0; }
  /* removed small circular "ball" */

  .image-placeholder.flair-ring{ transform: rotate(3deg) translateY(-5px); }
  .image-placeholder.flair-ring::before{ content: ''; position: absolute; right: -22px; bottom: -10px; width: 84px; height: 84px; border-radius: 50%; border: 6px solid var(--placeholder-accent); opacity: 0.9; z-index: 0; }
  .image-placeholder.flair-ring::after{ content: ''; position: absolute; right: -6px; bottom: -6px; width: 36px; height: 36px; border-radius: 50%; border: 3px solid var(--placeholder-accent); opacity: 0.9; z-index: 0; }

  /* remove rings and blur decorations but keep rotation */
  .image-placeholder.flair-twist::before,
  .image-placeholder.flair-twist::after,
  .image-placeholder.flair-spark::before,
  .image-placeholder.flair-spot::before,
  .image-placeholder.flair-ring::before,
  .image-placeholder.flair-ring::after { display: none !important; }

  .placeholder-inner{ display:flex; flex-direction:column; align-items:center; justify-content:center; gap:0.35rem; position: relative; z-index: 1; }
  .placeholder-label{ font-size:0.95rem; color: inherit; }

  /* No hover flair on placeholders */
  .image-placeholder:hover{ box-shadow: 0 18px 48px rgba(10,10,10,0.12); }

  @media (max-width: 640px){
    .image-placeholder{ width: 100% !important; height: auto !important; transform: none !important; }
    .image-placeholder.accent-twist::before, .image-placeholder.accent-twist::after{ display: none; }
  }

  .image-placeholder.tall{ aspect-ratio: 4 / 6; }
</style>

<style is:global>
  .media-col .image-placeholder.wide{ width: 420px !important; height: auto !important; }
  .media-col .image-placeholder.tall{ width: 300px !important; aspect-ratio: 4 / 6; height: auto !important; }
  @media (max-width:880px){ .media-col .image-placeholder.wide, .media-col .image-placeholder.tall{ width: 100% !important; height: auto !important; aspect-ratio: auto !important; } }
</style>
